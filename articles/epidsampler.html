<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulate an epidemic map with mobility and social interaction between individuals • epidsampler</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Simulate an epidemic map with mobility and social interaction between individuals">
<meta property="og:description" content="epidsampler">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">epidsampler</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/epidsampler.html">Getting started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../authors.html">Authors</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/vincnardelli/epidsampler/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="epidsampler_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="epidsampler_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="epidsampler_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Simulate an epidemic map with mobility and social interaction between individuals</h1>
                        <h4 class="author">Vincenzo Nardelli</h4>
            
            <h4 class="date">02/09/2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/vincnardelli/epidsampler/blob/master/vignettes/epidsampler.Rmd"><code>vignettes/epidsampler.Rmd</code></a></small>
      <div class="hidden name"><code>epidsampler.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vincnardelli/epidsampler">epidsampler</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span></code></pre></div>
<p>The simulation is divided in two main function. We generate the regular squared lattice grid and the individuals using genmap(). Then, for each day of the simulation (referred as “step”), we simulate the mobility, social interaction and the evolution of the epidemics with the infection and evolution of the disease for each individual in the map.</p>
<div id="map-generation" class="section level1">
<h1 class="hasAnchor">
<a href="#map-generation" class="anchor"></a>Map generation</h1>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span>
<span class="va">map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/genmap.html">genmap</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">5</span>, p<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">50</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; 1/2: Grid generated</span>
<span class="co">#&gt; 2/2: People generated</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">map</span><span class="op">)</span>
<span class="co">#&gt; Epidmic generated map </span>
<span class="co">#&gt; Dimension 5 x 5 </span>
<span class="co">#&gt; Total 777 people</span></code></pre></div>
<div id="parameters" class="section level4">
<h4 class="hasAnchor">
<a href="#parameters" class="anchor"></a>Parameters:</h4>
<ul>
<li>
<strong>n</strong> grid dimension</li>
<li>
<strong>p</strong> people density min/max - uniform distribution</li>
</ul>
<p>For the map generation we considered a population distributed into spatial units laid on a <strong>n</strong>-by-<strong>n</strong> regular squared lattice grid. Each square of the grid contains a number of individuals randomly drawn from a uniform distribution ranging between the two values contained in the vector <strong>p</strong>. This geographical representation is very general in that the map thus generated can represent, e. g., a city divided into blocks or a region divided into smaller spatial union or any other meaningful geographical partition.</p>
</div>
</div>
<div id="simulation" class="section level1">
<h1 class="hasAnchor">
<a href="#simulation" class="anchor"></a>Simulation</h1>
<div id="mobility" class="section level2">
<h2 class="hasAnchor">
<a href="#mobility" class="anchor"></a>Mobility</h2>
<div id="parameters-1" class="section level4">
<h4 class="hasAnchor">
<a href="#parameters-1" class="anchor"></a>Parameters:</h4>
<ul>
<li>
<strong>m</strong> % of moving people</li>
<li>
<strong>s</strong> step size</li>
</ul>
<p>The contagion mechanism is favoured by people mobility. In this simulation, we assumed that in any moment of time a certain percentage <strong>m</strong> of the population can move between the squares. In this way it is possible to distinguish different epidemic phases such as free-to-move period and lockdown. The commuting during the lockdown period is not only limited by the number of people who move, but also by the extent of their movements. This is a further simulation parameter which is generated by a uniform distribution ranging from <strong>-s</strong> to <strong>s</strong>.</p>
</div>
</div>
<div id="social-interaction" class="section level2">
<h2 class="hasAnchor">
<a href="#social-interaction" class="anchor"></a>Social interaction</h2>
<div id="parameters-2" class="section level4">
<h4 class="hasAnchor">
<a href="#parameters-2" class="anchor"></a>Parameters:</h4>
<ul>
<li>
<strong>cn</strong> mean of contacts inside a tile</li>
<li>
<strong>cp</strong> mean of number of people for each contact</li>
<li>
<strong>im</strong> mean of number of people infected</li>
</ul>
<p>Given the mobility pattern described above, contagion is determined by the social interaction and the contact opportunities. The number of contacts in each square of the grid is assumed to be determined by a random number drawn from a Poisson distribution with parameter, say <strong>cn</strong>, while the number of people involved in the movements is also a Poisson number characterised but a different parameter <strong>cp</strong>. Given these assumptions, a contagion occurs in the following way. If in a meeting it is present at least one asymptomatic or an exposed person, <strong>im</strong> susceptibles will be infected moving in the status of the Exposed.</p>
</div>
</div>
<div id="evolution-of-the-epidemics" class="section level2">
<h2 class="hasAnchor">
<a href="#evolution-of-the-epidemics" class="anchor"></a>Evolution of the epidemics</h2>
<div id="classification-of-individuals" class="section level4">
<h4 class="hasAnchor">
<a href="#classification-of-individuals" class="anchor"></a>Classification of individuals:</h4>
<ul>
<li>
<strong>S</strong> subsceptible</li>
<li>
<strong>E</strong> exposed</li>
<li>
<strong>I</strong> infected</li>
<li>
<strong>R</strong> removed</li>
<li>
<strong>D</strong> death<br>
</li>
<li>
<strong>A</strong> asyntomatic</li>
</ul>
</div>
<div id="parameters-3" class="section level4">
<h4 class="hasAnchor">
<a href="#parameters-3" class="anchor"></a>Parameters:</h4>
<ul>
<li>
<strong>tE</strong> number of days of E condition</li>
<li>
<strong>tI</strong> number of days of I condition</li>
<li>
<strong>tA</strong> number of days of A condition</li>
<li>
<strong>ir</strong> infected rate I/(A+I)</li>
<li>
<strong>cfr</strong> case fatality rate</li>
</ul>
<p>First of all, in order to simulate an artificial population describing the time evolution of an epidemics, we considered a popular model constituted by a system of six differential equations which, in each moment of time, describe six categories of individuals, namely: the susceptibles (S), those exposed to the virus (E), the infected with symptoms (I), those without symptoms (A) and those that are removed from population either because healed (R) or dead (D). This modelling framework is due to the seminal contribution of Hamer (1906), Kermack and McKendrick (1927) and Soper (1929) and it is often referred to as the “SIR model” from the initials of the categories considered in the first simplified formulation: Susceptibles, Infected and Removed. A comprehensive overview of this model is contained in Cliff et al. (1981). See also Vynnycky and White (2010).</p>
<p>For the data random generation, we assumed that, if infected, a susceptible element of the population (S) will remain in the exposed state (E) for the time <strong>tE</strong>. After that period the subject can become either infected with symptoms (I) with probability <strong>ir</strong> or without (asymptomatic; symbol A) with probability <strong>1-ir</strong>. The asymptomatic will remain infected (and so still able to transmit the virus) for <strong>tA</strong> days. After this period all the asymptomatic will be considered healed and will pass to the category removed (R). In contrast, the infected people showing symptoms will be healed with probability <strong>1-cfr</strong> or die (D) with probability <strong>cfr</strong> (case death rate).</p>
<p>The first simulation does not consider asyntomatic in the evolution of the epidemics.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">map</span> <span class="op">&lt;-</span> <span class="va">map</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="../reference/addsteps.html">addsteps</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">21</span>, m<span class="op">=</span><span class="fl">0.1</span>, s<span class="op">=</span><span class="fl">2</span>,
             cn<span class="op">=</span><span class="fl">6</span>, cp<span class="op">=</span><span class="fl">5</span>,
             im<span class="op">=</span><span class="fl">3</span>, tE<span class="op">=</span><span class="fl">5</span>, tA<span class="op">=</span><span class="fl">14</span>,
             tI<span class="op">=</span><span class="fl">14</span>, ir<span class="op">=</span><span class="fl">1</span>, cfr<span class="op">=</span><span class="fl">0.15</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="../reference/addsteps.html">addsteps</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">9</span>, m<span class="op">=</span><span class="fl">0.01</span>, s<span class="op">=</span><span class="fl">1</span>,
             cn<span class="op">=</span><span class="fl">1</span>, cp<span class="op">=</span><span class="fl">2</span>,
             im<span class="op">=</span><span class="fl">3</span>, tE<span class="op">=</span><span class="fl">5</span>, tA<span class="op">=</span><span class="fl">14</span>,
             tI<span class="op">=</span><span class="fl">14</span>, ir<span class="op">=</span><span class="fl">1</span>, cfr<span class="op">=</span><span class="fl">0.15</span><span class="op">)</span>
<span class="co">#&gt; simulating t 1 </span>
<span class="co">#&gt; simulating t 2 </span>
<span class="co">#&gt; simulating t 3 </span>
<span class="co">#&gt; simulating t 4 </span>
<span class="co">#&gt; simulating t 5 </span>
<span class="co">#&gt; simulating t 6 </span>
<span class="co">#&gt; simulating t 7 </span>
<span class="co">#&gt; simulating t 8 </span>
<span class="co">#&gt; simulating t 9 </span>
<span class="co">#&gt; simulating t 10 </span>
<span class="co">#&gt; simulating t 11 </span>
<span class="co">#&gt; simulating t 12 </span>
<span class="co">#&gt; simulating t 13 </span>
<span class="co">#&gt; simulating t 14 </span>
<span class="co">#&gt; simulating t 15 </span>
<span class="co">#&gt; simulating t 16 </span>
<span class="co">#&gt; simulating t 17 </span>
<span class="co">#&gt; simulating t 18 </span>
<span class="co">#&gt; simulating t 19 </span>
<span class="co">#&gt; simulating t 20 </span>
<span class="co">#&gt; simulating t 21 </span>
<span class="co">#&gt; simulating t 22 </span>
<span class="co">#&gt; simulating t 23 </span>
<span class="co">#&gt; simulating t 24 </span>
<span class="co">#&gt; simulating t 25 </span>
<span class="co">#&gt; simulating t 26 </span>
<span class="co">#&gt; simulating t 27 </span>
<span class="co">#&gt; simulating t 28 </span>
<span class="co">#&gt; simulating t 29 </span>
<span class="co">#&gt; simulating t 30</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">map</span><span class="op">)</span></code></pre></div>
<p><img src="epidsampler_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>With the parameter <strong>ir</strong> it is possibile to add the Aymptomatics.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/genmap.html">genmap</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">5</span>, p<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">50</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="../reference/addsteps.html">addsteps</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">21</span>, m<span class="op">=</span><span class="fl">0.1</span>, s<span class="op">=</span><span class="fl">2</span>,
             cn<span class="op">=</span><span class="fl">6</span>, cp<span class="op">=</span><span class="fl">5</span>,
             im<span class="op">=</span><span class="fl">3</span>, tE<span class="op">=</span><span class="fl">5</span>, tA<span class="op">=</span><span class="fl">14</span>,
             tI<span class="op">=</span><span class="fl">14</span>, ir<span class="op">=</span><span class="fl">0.25</span>, cfr<span class="op">=</span><span class="fl">0.15</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="../reference/addsteps.html">addsteps</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">9</span>, m<span class="op">=</span><span class="fl">0.01</span>, s<span class="op">=</span><span class="fl">1</span>,
             cn<span class="op">=</span><span class="fl">1</span>, cp<span class="op">=</span><span class="fl">2</span>,
             im<span class="op">=</span><span class="fl">3</span>, tE<span class="op">=</span><span class="fl">5</span>, tA<span class="op">=</span><span class="fl">14</span>,
             tI<span class="op">=</span><span class="fl">14</span>, ir<span class="op">=</span><span class="fl">0.25</span>, cfr<span class="op">=</span><span class="fl">0.15</span><span class="op">)</span>
<span class="co">#&gt; 1/2: Grid generated</span>
<span class="co">#&gt; 2/2: People generated</span>
<span class="co">#&gt; simulating t 1 </span>
<span class="co">#&gt; simulating t 2 </span>
<span class="co">#&gt; simulating t 3 </span>
<span class="co">#&gt; simulating t 4 </span>
<span class="co">#&gt; simulating t 5 </span>
<span class="co">#&gt; simulating t 6 </span>
<span class="co">#&gt; simulating t 7 </span>
<span class="co">#&gt; simulating t 8 </span>
<span class="co">#&gt; simulating t 9 </span>
<span class="co">#&gt; simulating t 10 </span>
<span class="co">#&gt; simulating t 11 </span>
<span class="co">#&gt; simulating t 12 </span>
<span class="co">#&gt; simulating t 13 </span>
<span class="co">#&gt; simulating t 14 </span>
<span class="co">#&gt; simulating t 15 </span>
<span class="co">#&gt; simulating t 16 </span>
<span class="co">#&gt; simulating t 17 </span>
<span class="co">#&gt; simulating t 18 </span>
<span class="co">#&gt; simulating t 19 </span>
<span class="co">#&gt; simulating t 20 </span>
<span class="co">#&gt; simulating t 21 </span>
<span class="co">#&gt; simulating t 22 </span>
<span class="co">#&gt; simulating t 23 </span>
<span class="co">#&gt; simulating t 24 </span>
<span class="co">#&gt; simulating t 25 </span>
<span class="co">#&gt; simulating t 26 </span>
<span class="co">#&gt; simulating t 27 </span>
<span class="co">#&gt; simulating t 28 </span>
<span class="co">#&gt; simulating t 29 </span>
<span class="co">#&gt; simulating t 30</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">map</span><span class="op">)</span></code></pre></div>
<p><img src="epidsampler_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Vincenzo Nardelli.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
