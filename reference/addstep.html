<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Add step — addstep • epidsampler</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Add step — addstep" />
<meta property="og:description" content="Simulate one step (i.e. one day) of mobility, social interaction and the evolution of the epidemics with the infection and evolution of the disease for each individual in the map." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">epidsampler</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/epidsampler.html">Getting started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../authors.html">Authors</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vincnardelli/epidsampler/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add step</h1>
    <small class="dont-index">Source: <a href='https://github.com/vincnardelli/epidsampler/blob/master/R/addstep.R'><code>R/addstep.R</code></a></small>
    <div class="hidden name"><code>addstep.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Simulate one step (i.e. one day) of mobility, social interaction and the evolution of the epidemics with the infection and evolution of the disease for each individual in the map.</p>
    </div>

    <pre class="usage"><span class='fu'>addstep</span><span class='op'>(</span>
  map <span class='op'>=</span> <span class='va'>map</span>,
  m <span class='op'>=</span> <span class='cn'>NULL</span>,
  s <span class='op'>=</span> <span class='cn'>NULL</span>,
  cn <span class='op'>=</span> <span class='cn'>NULL</span>,
  cp <span class='op'>=</span> <span class='cn'>NULL</span>,
  im <span class='op'>=</span> <span class='cn'>NULL</span>,
  tE <span class='op'>=</span> <span class='cn'>NULL</span>,
  tI <span class='op'>=</span> <span class='cn'>NULL</span>,
  tA <span class='op'>=</span> <span class='cn'>NULL</span>,
  ir <span class='op'>=</span> <span class='cn'>NULL</span>,
  cfr <span class='op'>=</span> <span class='cn'>NULL</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>map</th>
      <td><p>An epidmap object</p></td>
    </tr>
    <tr>
      <th>m</th>
      <td><p>A positive float. % of moving people</p></td>
    </tr>
    <tr>
      <th>s</th>
      <td><p>A positive integer. Step size</p></td>
    </tr>
    <tr>
      <th>cn</th>
      <td><p>A positive integer. Mean of contacts inside a tile</p></td>
    </tr>
    <tr>
      <th>cp</th>
      <td><p>A positive integer. Mean of number of people for each contact</p></td>
    </tr>
    <tr>
      <th>im</th>
      <td><p>A positive integer. Mean of number of people infected</p></td>
    </tr>
    <tr>
      <th>tE</th>
      <td><p>A positive integer. Number of days of E condition</p></td>
    </tr>
    <tr>
      <th>tI</th>
      <td><p>A positive integer. Number of days of I condition</p></td>
    </tr>
    <tr>
      <th>tA</th>
      <td><p>A positive integer. Number of days of A condition</p></td>
    </tr>
    <tr>
      <th>ir</th>
      <td><p>A positive float. Infected rate I/(A+I)</p></td>
    </tr>
    <tr>
      <th>cfr</th>
      <td><p>A positive float.case Fatality rate</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>A logical</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>an epidmap object</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    
<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Mobility</h3>


<p>The contagion mechanism is favoured by people mobility. In this simulation, we assumed that in any moment of time a certain percentage <strong>m</strong> of the population can move between the squares. In this way it is possible to distinguish different epidemic phases such as free-to-move period and lockdown. The commuting during the lockdown period is not only limited by the number of people who move, but also by the extent of their movements. This is a further simulation parameter which is generated by a uniform distribution ranging from <strong>-s</strong> to <strong>s</strong>.</p>

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Social interaction</h3>


<p>Given the mobility pattern described above, contagion is determined by the social interaction and the contact opportunities. The number of contacts in each square of the grid is assumed to be determined by a random number drawn from a Poisson distribution with parameter, say <strong>cn</strong>, while the number of people involved in the movements is also a Poisson number characterised but a different parameter <strong>cp</strong>. Given these assumptions, a contagion occurs in the following way. If in a meeting it is present at least one asymptomatic or an exposed person, <strong>im</strong> susceptibles will be infected moving in the status of the Exposed.</p>

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Evolution of the epidemics</h3>


<p>First of all, in order to simulate an artificial population describing the time evolution of an epidemics, we considered a popular model constituted by a system of six differential equations which, in each moment of time, describe six categories of individuals, namely: the susceptibles (S), those exposed to the virus (E), the infected with symptoms (I), those without symptoms (A) and those that are removed from population either because healed (R) or dead (D). This modelling framework is due to the seminal contribution of Hamer (1906), Kermack and McKendrick (1927) and Soper (1929) and it is often referred to as the “SIR model” from the initials of the categories considered in the first simplified formulation: Susceptibles, Infected and Removed.
For the data random generation, we assumed that, if infected, a susceptible element of the population (S) will remain in the exposed state (E) for the time <strong>tE</strong>. After that period the subject can become either infected with symptoms (I) with probability <strong>ir</strong> or without (asymptomatic; symbol A) with probability <strong>1-ir</strong>. The asymptomatic will remain infected (and so still able to transmit the virus) for <strong>tA</strong> days. After this period all the asymptomatic will be considered healed and will pass to the category removed (R). In contrast, the infected people showing symptoms will be healed with probability <strong>1-cfr</strong> or die (D) with probability <strong>cfr</strong> (case death rate).</p>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>12345</span><span class='op'>)</span>
<span class='va'>map</span> <span class='op'>&lt;-</span> <span class='fu'><a href='genmap.html'>genmap</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='fl'>5</span>, p<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>50</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>map</span> <span class='op'>&lt;-</span> <span class='va'>map</span> <span class='op'>%&gt;%</span>
 <span class='fu'>addstep</span><span class='op'>(</span>m<span class='op'>=</span><span class='fl'>0.03</span>, s<span class='op'>=</span><span class='fl'>2</span>,
          cn<span class='op'>=</span><span class='fl'>4</span>, cp<span class='op'>=</span><span class='fl'>2</span>,
          im<span class='op'>=</span><span class='fl'>3</span>, tE<span class='op'>=</span><span class='fl'>5</span>, tA<span class='op'>=</span><span class='fl'>14</span>,
          tI<span class='op'>=</span><span class='fl'>14</span>, ir<span class='op'>=</span><span class='fl'>1</span>, cfr<span class='op'>=</span><span class='fl'>0.15</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Vincenzo Nardelli.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


